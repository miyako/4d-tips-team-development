# 4d-tips-team-development

### アプリケーションをチームで開発したい場合，どのような選択肢がありますか

1. バイナリモード vs プロジェクトモード
1. ローカルクライアント vs リモートクライアント (v18 R4以降)
1. Team Developer Professional vs Developer Professional ライセンス

#### プロジェクトモード vs バイナリモード

[4Dでデータベースアプリケーションを作成する](https://doc.4d.com/4Dv18/4D/18/Creating-a-new-database.300-4575701.ja.html)場合，単一のストラクチャファイル（拡張子`.4DB`）を使用する**バイナリモード**，または多数のテキストファイルを使用する**プロジェクトモード**のいずれかを最初に選択します。[ストラクチャファイルをプロジェクトに変換する](https://doc.4d.com/4Dv18/4D/18/Converting-databases-to-projects.300-4606146.ja.html)ことはできますが，その逆，つまりプロジェクトをストラクチャファイルに変換することはできません。今後，**新機能**は原則的にプロジェクトモードで提供されることになります。一方，バイナリモードでは（技術的に可能な限り）さまざまな旧式の仕様が引き続きサポートされます。

**注記**: バージョン18 R4以降，プロジェクトモードが既定のフォーマットとなりました。バイナリモードのアプリケーションを作成するためには，アプリケーションの**環境設定**で「バイナリー形式のデータベース作成を有効化する」チェックボックスを有効にする必要があります。

プロジェクトモードは，全面的にテキストファイルを使用するため，**バージョン管理システム**（VCS）を活用したチーム開発に向いています。たとえば，チームのメンバーが個別に実施した変更を統合したり，選択的に採用したりすることができます。一方，バイナリモードはクライアント/サーバーの排他的にアクセス管理を活用した**ライブ開発**ができるというメリットがあります。

* バイナリモードのチーム開発

ストラクチャファイル（`.4DB`）をサーバーで開きます。デベロッパーはそれぞれクライアントを起動してサーバーに接続し，フォームエディターやメソッドエディターでアプリケーションを編集します。誰かがエディターで開いているフォームやメソッドはロックされ，別のデベロッパーは編集できません。フォームやメソッドには[アクセスグループ](https://doc.4d.com/4Dv18/4D/18/Assigning-a-group-to-database-objects.300-4575496.ja.html)を設定することもできます。

![v18-version-control 020](https://user-images.githubusercontent.com/1725068/110051746-c1cf7900-7d99-11eb-8009-a70cf76b3001.jpeg)

**メリット**: 運用中のアプリケーションに修正を加えることができ，変更の内容はすぐに反映されます。ハイライトボタン・ピクチャボタン・スタンドアロン版でのパスワード管理・スクロールエリア風に結合されたリストボックスなど，プロジェクトモードで廃止された旧式の仕様が引き続き使用できます。いずれプロジェクトモードに移行するという選択肢も残されています。

**デメリット**: サーバーに接続する必要があるので，デベロッパーはオンラインでなければなりません。当然，クライアント接続ライセンスも消費します。変更を取り消したい場合，バックアップからストラクチャファイルを復元しなければなりません。変更の履歴は，スプレッドシートなどで独自に管理する必要があります。クラス・CSS・Apple Silicon向けのコンパイル（v19）など，プロジェクトモード限定の新しい機能が使用できません。

* プロジェクトモードのチーム開発

それぞれのデベロッパーがプロジェクトのコピーを入手し，ローカルで開きます。開発に4D Serverは使用しません。メソッド（拡張子`.4DM`），フォーム（拡張子`.4DForm`），スタイルシート（`.css`），データベース定義（`.4DCatalog`）など，ソースコードはすべて標準テキストファイルなので，お気に入りのコードエディターや統合開発環境で編集したり，Git，Perforce, Subversionなどのバージョン管理システムにホストさせたりすることができます。

![v18-version-control 045](https://user-images.githubusercontent.com/1725068/110053871-74550b00-7d9d-11eb-9472-f2d4735ff3b9.jpeg)

**メリット**: リアルタイムで同時に開発するわけではないので，デベロッパーが常時オンラインである必要はありません。クライアント接続ライセンスも消費しません。バージョン管理システムを併用すれば，作業を分担したり，実験的な開発を進めたり，変更を取り消したりすることが容易です。クラス・CSS・Apple Silicon向けのコンパイル（v19）など，プロジェクトモード限定の新しい機能が使用できます。

**デメリット**: 運用中のアプリケーションとは別の環境で開発・テスト・コンパイルを実施するため，ある時点でサーバーを停止し，アプリケーションを入れ替える必要があります（後述のローカルクライアントを使用しない場合）。バイナリモードに引き返すことはできません。ソースコードに対するアクセスがあれば，誰でも（さらに言えば4Dを起動しなくても）アプリケーションの開発ができるため，フォームやメソッドに対するアクセス管理は無意味なものとなります。権限を管理するのであれば，ファイルそのものに対するアクセスを管理する必要があります。

#### ローカルクライアント vs リモートクライアント

プロジェクトモードのアプリケーションを4D Serverで開いた場合，インタープリターモードであれば，クライアントでサーバーに接続し，メソッドやフォームをエディターで開くことができますが，編集することはできません。つまり，バイナリモードのようにライブ開発をすることはできません。もちろん，サーバー側のソースコードをコードエディターなどで開いて編集したり，リモートで編集したソースコードをサーバーにアップロードしたりすることはできますが，変更はサーバーアプリケーションを再起動するまで反映されません。

[v18 R4](https://blog.4d.com/server-code-development-in-project-applications/)では，サーバーマシン側で起動したクライアント（**ローカルクライアント**）に限り，実行中のプロジェクトが編集できるようになりました。ローカルクライアントのファイルメニューで「すべて保存」を選択したり，デザインモードからアプリケーションモードに切り替えたり，サーバーアプリケーションを最前面に移動したりすれば，プロジェクトがリロードされ，変更が反映されます。[RELOAD PROJECT](https://doc.4d.com/4Dv18R5/4D/18-R5/RELOAD-PROJECT.301-5128720.ja.html)を実行することもできます。

![v18-version-control 036](https://user-images.githubusercontent.com/1725068/110056218-bb44ff80-7da1-11eb-9926-5ada59152f1b.jpeg)

|　| バイナリモード | プロジェクトモード＋リモートクライアント | プロジェクトモード＋ローカルクライアント（v18 R4以降） |
|:-- |:--:|:--:|:--:|
|4D Serverで開発| ● |  | ● |
|4Dで開発| ● | ● | ● |
